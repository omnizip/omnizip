---
title: PPMd
nav_order: 6
parent: Compression Algorithms
grand_parent: Guides
---

== Purpose

PPMd7 (Prediction by Partial Matching, variant H revision 7) is a statistical compression algorithm that excels at compressing text files. It achieves excellent compression ratios on source code, documents, and repetitive text.

== Key Characteristics

[cols="1,3"]
|===
|Property |Value

|Compression Ratio
|Excellent (best for text)

|Compression Speed
|Slow

|Decompression Speed
|Slow

|Memory Usage
|High (configurable)

|Best For
|Text files, source code, XML/JSON, logs
|===

== When to Use PPMd7

**Choose PPMd7 when**:

* Compressing primarily text data
* Source code archives
* XML, JSON, or structured text files
* Log file archives
* Maximum text compression is needed

**Avoid PPMd7 when**:

* Working with binary data (use LZMA2)
* Working with already-compressed files
* Speed is more important than ratio
* Memory is very limited

== Basic Usage

=== Compress Text Files

[source,ruby]
----
# Compress source code with PPMd7
Omnizip::Archive.create('code.7z', format: :seven_zip) do |archive|
  archive.compression = :ppmd7
  archive.level = 6  # Default
  archive.add_directory('src/')
end
----

=== Configure Memory

PPMd7 uses configurable memory (2^mem_size bytes):

[source,ruby]
----
# Configure PPMd7 memory and order
Omnizip::Archive.create('text.7z', format: :seven_zip) do |archive|
  archive.compression = :ppmd7
  archive.mem_size = 24  # 2^24 = 16 MB
  archive.order = 6      # Context order (default)
  archive.add_directory('documents/')
end
----

== Configuration Parameters

=== Memory Size

Controls context tree size (2^mem_size bytes):

[cols="1,1,2,2"]
|===
|mem_size |Memory |Compression |Best For

|20
|1 MB
|Good
|Small files, limited memory

|22
|4 MB
|Very Good
|Most text files

|24
|16 MB
|Excellent
|**Default** - large texts

|26
|64 MB
|Best
|Very large text corpora

|28
|256 MB
|Maximum
|Huge text archives
|===

=== Context Order

Number of previous characters used for prediction:

[cols="1,2,2"]
|===
|Order |Compression |Speed

|4
|Good
|Faster

|6
|Excellent
|**Default**

|8
|Best
|Slower

|16
|Maximum
|Very slow
|===

.Configuration Example
[source,ruby]
----
# For large source code archive
Omnizip::Archive.create('linux-kernel.7z', format: :seven_zip) do |archive|
  archive.compression = :ppmd7
  archive.mem_size = 26  # 64 MB memory
  archive.order = 8      # Deep context
  archive.add_directory('linux-6.0/')
end
----

== Performance Characteristics

=== Compression Ratios (Text Files)

[cols="2,1,1,1"]
|===
|Content Type |Deflate |LZMA2 |PPMd7

|Source Code (.rb, .js)
|65%
|72%
|78%

|XML/JSON
|68%
|75%
|82%

|Plain Text
|62%
|70%
|80%

|Logs (repetitive)
|70%
|76%
|85%
|===

=== Speed Comparison

For 10 MB text file:

[cols="2,1,1,1"]
|===
|Algorithm |Compress Time |Decompress Time |Ratio

|**PPMd7**
|25s
|18s
|80%

|LZMA2
|15s
|2s
|75%

|Deflate
|3s
|1s
|65%

|Zstandard
|1s
|0.5s
|68%
|===

== Common Use Cases

=== Source Code Archives

[source,ruby]
----
# Archive project source code
Omnizip::Archive.create("project-v1.0.7z", format: :seven_zip) do |archive|
  archive.compression = :ppmd7
  archive.mem_size = 24  # 16 MB
  archive.order = 6
  archive.add_directory('src/')
  archive.add_directory('tests/')
  archive.add_file('README.md')
end
----

=== Log File Compression

[source,ruby]
----
# Compress application logs with maximum ratio
log_files = Dir.glob('/var/log/app/*.log')

Omnizip.compress_files(
  log_files,
  "logs_#{Date.today}.7z",
  compression: :ppmd7,
  mem_size: 26,  # 64 MB for large logs
  order: 8
)
----

=== Documentation Archives

[source,ruby]
----
# Compress documentation and markup files
Omnizip::Archive.create('docs.7z', format: :seven_zip) do |archive|
  archive.compression = :ppmd7
  archive.add_directory('docs/')
  archive.add_directory('wiki/')
  archive.add_directory('examples/')
end
----

== PPMd7 vs PPMd8

Both are variants of PPMd with slight differences:

[cols="2,1,1,2"]
|===
|Characteristic |PPMd7 |PPMd8 |Recommendation

|Compression Ratio
|Excellent
|Excellent
|Similar quality

|Speed
|Slow
|Slow
|Similar performance

|Memory Usage
|High
|High
|Similar requirements

|Compatibility
|Wider
|Limited
|Use PPMd7 for compatibility

|Default in 7-Zip
|Yes
|No
|PPMd7 is standard
|===

**Recommendation**: Use PPMd7 unless you have specific reasons to use PPMd8.

== Optimization Tips

. **Match Memory to File Size**: Use larger memory for larger files
. **Higher Order for Repetitive Text**: Increase order for highly structured text
. **Use Solid Archives**: PPMd benefits greatly from solid compression
. **Combine with Preprocessing**: Generally not needed for text
. **Monitor Memory Usage**: Ensure sufficient RAM available

== Technical Details

**Algorithm Type**: Statistical context modeling

**Prediction Method**: Partial Matching with escape codes

**Context Length**: Configurable (order parameter)

**Memory Model**: Explicit memory size configuration

**Compatibility**: Standard PPMd variant H implementation

== See Also

* link:lzma2.html[LZMA2] - General-purpose alternative
* link:../../compatibility.html[Compatibility] - PPMd support across tools